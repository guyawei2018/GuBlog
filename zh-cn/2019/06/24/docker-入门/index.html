<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta name="generator" content="Hugo 0.55.6" />
  <meta charset="utf-8">
  <title>Docker 入门 · GUBlog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Docker 思想 1.集装箱 2.标准化(运输方式、存储方式、API接口) 3.隔离 Docker 解决了什么问题？ 1.运行环境不一致 2.独立运行、隔离进程 3.快速增加服" />

  <meta name="keywords" content="Hugo, theme, den" />

<link rel="canonical" href="https://guyawei.top/zh-cn/2019/06/24/docker-%E5%85%A5%E9%97%A8/" />

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
<link rel="stylesheet" href="https://guyawei.top/css/den.css">

<link rel="stylesheet" href="https://guyawei.top/css/den.css">




<meta property="og:title" content="Docker 入门" />
<meta property="og:description" content="Docker 思想 1.集装箱 2.标准化(运输方式、存储方式、API接口) 3.隔离 Docker 解决了什么问题？ 1.运行环境不一致 2.独立运行、隔离进程 3.快速增加服" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://guyawei.top/zh-cn/2019/06/24/docker-%E5%85%A5%E9%97%A8/" />
<meta property="article:published_time" content="2019-06-24T16:01:23&#43;08:00"/>
<meta property="article:modified_time" content="2019-06-24T16:01:23&#43;08:00"/>

<meta itemprop="name" content="Docker 入门">
<meta itemprop="description" content="Docker 思想 1.集装箱 2.标准化(运输方式、存储方式、API接口) 3.隔离 Docker 解决了什么问题？ 1.运行环境不一致 2.独立运行、隔离进程 3.快速增加服">


<meta itemprop="datePublished" content="2019-06-24T16:01:23&#43;08:00" />
<meta itemprop="dateModified" content="2019-06-24T16:01:23&#43;08:00" />
<meta itemprop="wordCount" content="1662">



<meta itemprop="keywords" content="java," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker 入门"/>
<meta name="twitter:description" content="Docker 思想 1.集装箱 2.标准化(运输方式、存储方式、API接口) 3.隔离 Docker 解决了什么问题？ 1.运行环境不一致 2.独立运行、隔离进程 3.快速增加服"/>
</head>
<body>
  
  <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('http://gu-static.oss-cn-shanghai.aliyuncs.com/GuBlog/img/home-bg-jeep.jpg'); background-position: center; background-size: cover;">
  <div class="container">
  <nav class="header-nav navbar navbar-expand-md navbar-dark light-dark">
    <div class="header-logo navbar-brand">
      
        <a class="float-left" href="https://guyawei.top/zh-cn/">
      
        
        <img class="mr20 header-logo-image" src="https://guyawei.top/images/globe.svg" alt="logo">
        
        
          GU
         
      </a>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="nav-menu collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        
          <li class="nav-item">
            
              
              <a class="nav-link" href="https://guyawei.top/zh-cn/category/java/">java</a>
              
            
          </li>
        
          <li class="nav-item">
            
              
              <a class="nav-link" href="https://guyawei.top/zh-cn/category/demos/">生活</a>
              
            
          </li>
        
          <li class="nav-item">
            
              
              <a class="nav-link" href="https://guyawei.top/zh-cn/category/notes/">笔记</a>
              
            
          </li>
        
          <li class="nav-item">
            
            <a class="nav-link" href="https://guyawei.top/zh-cn/about/">关于</a>
            
          </li>
        
        
          
            
          
          
          
            
          
          
          
          
        
      </ul>
    </div>
  </nav>
</div>

<div class="container header-wrapper">
  <div class="row">
    <div class="col-lg-12">
      <div class="header-content">
        <h1 class="header-title">Docker 入门</h1>
        <p class="header-date">作者：
          GUYW /
        
        2019-06-24
          / 分类：
          <a href="https://guyawei.top/zh-cn/category/java/">Java</a>
        </p>
        
        <div class="header-underline"></div>
        
          <div class="clearfix"></div>
          <p class="float-right header-tags">
              <i class="fas fa-tags" aria-hidden="true"></i>
              <a href="https://guyawei.top/zh-cn/tag/java/">java</a>
          </p>
        
        

      </div>
    </div>
  </div>
</div>

  </div>
  <main>
<div class="container content">
  <article>
  

<h2 id="docker-思想">Docker 思想</h2>

<ul>
<li>1.集装箱<br></li>
<li>2.标准化(运输方式、存储方式、API接口)<br></li>

<li><p>3.隔离<br></p>

<h2 id="docker-解决了什么问题">Docker 解决了什么问题？</h2></li>

<li><p>1.运行环境不一致<br></p></li>

<li><p>2.独立运行、隔离进程<br></p></li>

<li><p>3.快速增加服务器（京东已实现所有业务Docker,Docker实例有15万个）<br></p>

<h2 id="docker-几个专业术语">Docker 几个专业术语</h2></li>

<li><p>1.image 称为镜像，可以理解为集装箱，image的实现是利用Linux系统底层的联合文件系统(文件分层)，实现镜像存储。image可以对应bulid(构建)<br></p></li>

<li><p>2.仓库可以理解为集装箱码头，对应ship(运输)<br></p></li>

<li><p>3.容器可以理解为运行的程序，包含程序执行文件和系统运行文件，也是运行的image。对应run(执行)<br></p>

<h2 id="docker-在linux安装-br">Docker 在Linux安装<br></h2>

<p><strong>Docker支持以下的CentOS版本</strong><br>
CentOS 7 (64-bit)        CentOS 6.5 (64-bit) 或更高的版本<br>
使用 yum 安装（CentOS 7下）<br>
Docker 要求 CentOS 系统的内核版本高于 3.10 ，查看本页面的前提条件来验证你的CentOS 版本是否支持 Docker<br>
<strong>通过 uname -r 命令查看你当前的内核版本</strong><br>
[root@runoob ~]# uname -r <br>
<strong>安装 Docker</strong><br>
从 2017 年 3 月开始 docker 在原来的基础上分为两个分支版本: Docker CE 和 Docker EE。<br>
Docker CE 即社区免费版，Docker EE 即企业版，强调安全，但需付费使用。<br>
本文介绍 Docker CE 的安装使用。</p></li>

<li><p>1.移除旧的版本：<br></p></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-plant" data-lang="plant">  yum remove docker \
            docker-client \
            docker-client-latest \
            docker-common \
            docker-latest \
            docker-latest-logrotate \
            docker-logrotate \
            docker-selinux \
            docker-engine-selinux \
            docker-engine</code></pre></div>
<ul>
<li>2.安装一些必要的系统工具：<br>
yum install -y yum-utils device-mapper-persistent-data lvm2</li>
<li>3.建议使用阿里云的地址，国外的地址，下载比较慢，而且很容易链接超时：<br>
官网地址<br>
sudo yum-config-manager <br />
&ndash;add-repo <br />
<a href="https://download.docker.com/linux/centos/docker-ce.repo">https://download.docker.com/linux/centos/docker-ce.repo</a><br>
阿里云地址<br>
yum-config-manager &ndash;add-repo <a href="http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a><br></li>
<li>4.更新 yum 缓存和安装docker<br>
yum makecache fast<br>
yum install docker-ce<br></li>
<li>5.启动 Docker 后台服务<br>
sudo systemctl start docker<br></li>

<li><p>6.测试运行 hello-world<br>
docker run hello-world</p>

<h2 id="docker-常用命令">Docker 常用命令</h2>

<p><strong>Docker帮助命令</strong><br></p></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-plant" data-lang="plant">    docker version
    docker info
    docker --help</code></pre></div>
<p><strong>镜像命令</strong><br></p>
<div class="highlight"><pre class="chroma"><code class="language-plant" data-lang="plant">  查看本地镜像列表
  docker image ls 
  docker images [-a(列出本地所有的镜像-含中间映像层)/-q(只显示镜像ID)]

  docker pull  [不写默认中央仓库]  imagename  [TAG]--镜像版本默认最新版本

  docker search 镜像名字 [--no-trunc(显示完整的镜像描述)/-s(列出收藏数不小于指定值的镜像)/--automated(只列出automated build类型的镜像)]

  删除镜像
  docker rmi [-f(强制删除)] imageName/多个imageName

  删除全部镜像
  docker rmi -f $(docker images - q)</code></pre></div>
<p><strong>容器命令</strong><br></p>
<div class="highlight"><pre class="chroma"><code class="language-plant" data-lang="plant">  运行镜像
  docker run [options] imageName [TAG][COMMANP][ARG]
  [options说明]
  --name=&#34;name&#34;:为容器指定一个名称
  -d:后台运行模式
  -i:以交互模式运行容器
  -t:为容器重新分配一个伪输入终端，通常与-i同时使用
  -P:随机分配端口映射
  -p:指定端口映射

  例: docker run -d -p 8080:8080 [-v xxxxxxxx]  tomcat《后台运行tomcat容器端口映射是8080，如果有-v可以用外部文件替代内部文件》

  查看已经运行的容器
  docker ps
  docker ps -a

  运行容器
  docker start containerId
  停止容器
  docker stop containerId
  docker kill containerId
  重启容器
  docker restart containerId
  删除容器
  docker rm containerId
  强制删除容器
  docker rm -f containerId
  容器不停止退出
  ctrl+P+Q
  进入正在运行的容器并以命令行交互
  docker exec(再容器中打开新的终端，并且可以启动新的进程)/attach(之间进入容器启动命令终端，不会启动新的进程) -it 容器名/容器ID  bash
  查看容器日志
  docker logs -f -t --tail containerId
  查看容器进程
  docker top containerId
  查看容器内部细节（重要）
  docker inspect containerId
  从容器内拷贝文件到主机上
  docker cp  containerId:文件绝对路径  宿主机文件路径
  替换docker 内部文件
  docker cp 文件路径 containerId:文件绝对路径  
  
  </code></pre></div>
<p><strong>运行nginx</strong><br>
docker run &ndash;name docker_nginx -d -p 80:80 <br>
  -v /zzz/mynginx/nginx/log:/var/log/nginx<br>
  -v /zzz/mynginx/nginx/conf:/etc/nginx/conf.d<br>
  -v /zzz/mynginx/nginx/nginx.conf:/etc/nginx/nginx/conf<br>
  -v /zzz/mynginx/nginx/html:/lx/html<br>
  nginx<br>
第一个-v:挂载日志目录<br>
第二个-v:挂载配置目录<br>
第三个-v:干脆把配置文件直接挂出来，不推荐<br>
第四个-v:挂载项目目录<br></p>

<p><strong>其他指令</strong><br>
docker container ls &ndash;all &mdash;查看所有容器（包含未运行的容器）<br>
docker commit -m  &ldquo;&rdquo;   -a  &ldquo;&rdquo;   [CONTAINER ID]  [给新的镜像命名]   &mdash;&ndash;打包成镜像<br>
systemctl enable docker    设置docker开机自启动
docker update &ndash;restart 容器ID   设置docker容器自启动</p>

<h2 id="部署镜像私有仓库">部署镜像私有仓库</h2>

<ul>
<li>1.下载镜像registry<br>
$ docker pull registry<br></li>
<li>2.启动容器<br>
$ docker run -d -p 5000:5000  &ndash;name=registry-srv [-v /mydata/dockerRegistry:/var/lib/registry] registry<br>
<img src="http://gu-static.oss-cn-shanghai.aliyuncs.com/GuBlog/img/docker/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190625200858.png" alt="图片" /></li>
<li>3.作制本地镜像上传仓库<br>
$ docker tag 源镜像 仓库IP:5000/目标镜像<br></li>
<li>4.上传tag镜像到仓库<br>
docker push 制作好的image<br>
说明：push 会出现错误 Get <a href="https://xxxxxxxx:5000/v1/_ping:">https://xxxxxxxx:5000/v1/_ping:</a> http: server gave HTTP response to HTTPS client<br>
这是因为Docker在1.3.x之后默认docker registry使用的是https，为了解决这个问题，修改本地主机的docker启动配置文件<br>
$ vim /etc/docker/daemon.json  不存在就新建<br>
<strong>{&ldquo;insecure-registries&rdquo;:[&ldquo;192.168.84.104:5000&rdquo;]}</strong>
<img src="http://gu-static.oss-cn-shanghai.aliyuncs.com/GuBlog/img/docker/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190625202047.png" alt="图片" /></li>
</ul>

  </article>

  
  
    
    <div class="author-card">
    <div class="underline"></div>
    <div class="author-box">
      <div class="author-image"><a href="https://106.15.235.215"><img src="/images/blank-profile.png" alt="GUYW" /></a></div>
      <div class="author-content">
      <p class="author-title">作者</p>
      <p class="author-name">GUYW</p>
      <p class="author-desc">心在远方，路在脚下</p>
      </div>
    </div>
  </div>
    
  
  


</div>

  </main><div class="footer gradient-2">
  <div class="container footer-container ">
    <div class="row">
      <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
        <div class="footer-title">网站地图</div>
        <ul class="list-unstyled">
            
              
                <li><a href="https://guyawei.top/zh-cn/tags/">标签</a></li>
              
              
                <li><a href="https://guyawei.top/zh-cn/categories/">分类</a></li>
              
            
            
            
            <li><a rel="alternate" type="application/rss&#43;xml" href="https://guyawei.top/zh-cn/index.xml"><i class="fas fa-rss-square"></i> RSS订阅</a></li>
            
            
            
        </ul>
      </div>
      <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
        
        <div class="footer-title">社群</div>
        <ul class="list-unstyled">
          
          <li><a href="https://github.com/guyawei2018/" rel="noopener" target="_blank">GitHub</a></li>
          
        </ul>
        
      </div>
      <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
        
        <div class="footer-title">友链</div>
        <ul class="list-unstyled">
          
          <li><a href="https://github.com/shaform/hugo-theme-den/" rel="noopener" target="_blank">关于我</a></li>
          
        </ul>
        
      </div> 
      <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
        <p class="pull-right text-right">
          <small><em>Proudly powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo</a></em></small><br/>
          <small><em>Theme - <a href="https://github.com/shaform/hugo-theme-den" rel="noopener" target="_blank">Den</a></em></small><br/>
          <small>
            &copy; 
            Gu
            
              2017 -
            2020
          </small>
          
        </p>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

</body>
</html>
